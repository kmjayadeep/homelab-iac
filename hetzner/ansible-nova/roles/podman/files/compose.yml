version: '3.8'

services:
  # Make sure to chown the data and config directories to 1000:1000
  psuite-syncthing:
    image: docker.io/linuxserver/syncthing:2.0.10
    container_name: psuite-syncthing
    hostname: psuite-hetzner
    restart: always
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Zurich
    volumes:
      - psuite-data:/data
      - psuite-config:/config
    ports:
      - "8384:8384"  # Web UI
      - "22000:22000/tcp"  # Sync protocol (TCP)
      - "22000:22000/udp"  # Sync protocol (UDP)  
    networks:
      - psuite-network
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:8384/rest/noauth/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  psuite-data:
    driver: local
  psuite-config:
    driver: local

networks:
  psuite-network:
    driver: bridge
    enable_ipv6: true
    ipam:
      config:
        - subnet: "fd00:db8:1::/64"
          gateway: "fd00:db8:1::1"